<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

    <title>Quotes</title>

    <% is_bb6 = System::get_property('platform') == 'Blackberry' && (System::get_property('os_version').split('.')[0].to_i >= 6) %>

    <% if is_bb6 %>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <% else %>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <% end %>

    <% if System::get_property('platform') == 'WP7' %>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <% end %>

    <% if System::get_property('platform') == 'APPLE' || System::get_property('platform') == 'ANDROID' || is_bb6 || System::get_property('webview_framework') =~ /^WEBKIT/ %>
        <script src="/public/jquery/jquery-1.6.4.min.js" type="text/javascript"></script>

        <link rel="stylesheet" href="/public/jqmobile/jquery.mobile-1.0.1.min.css">
        <link rel="stylesheet" href="/public/css/jqmobile-patch.css">
        <% if System::get_property('platform') == 'APPLE' %>
            <link href="/public/jqmobile/jquery-mobile-iphone.css" type="text/css" rel="stylesheet"/>
        <% end %>

        <script type="text/javascript">
            $(document).bind("mobileinit", function(){
                // jQuery-Mobile init options initialization goes here. For example, you may
                // enable automatically generated 'Back' buttons on headers this way:
                //$.mobile.page.prototype.options.addBackBtn = true;

                // You can disable (with false value) or change page loading message
                $.mobile.loadingMessage = false;
                //$.mobile.loadingMessage = "loading"; // it is default value

                // For documented init options look here:
                // http://jquerymobile.com/demos/1.0/docs/api/globalconfig.html

                // For poorly documented options search for ".prototype.options"
                // in the jQuery Mobile source code

                // Rhodes custom option!
                // how long to wait transition end before "loading.." message will be shown
                $.mobile.loadingMessageDelay = 300; // in ms
            });
        </script>
        <script type="text/javascript" charset="utf-8" src="/public/jqmobile/jquery.mobile-1.0.1.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="/public/js/jqmobile-patch.js"></script>
        

    <% end %>

    <% if System::get_property('platform') == 'APPLE' %>
        <link href="/public/css/iphone.css" type="text/css" rel="stylesheet"/>
    <% elsif System::get_property('platform') == 'ANDROID' %>
        <link href="/public/css/android.css" type="text/css" rel="stylesheet"/>
    <% elsif is_bb6 %>
        <link href="/public/css/android.css" type="text/css" rel="stylesheet"/>
    <% elsif System::get_property('platform') == 'Blackberry' %>
        <link href="/public/css/blackberry.css" type="text/css" rel="stylesheet"/>
    <% elsif System::get_property('platform') == 'WP7' %>
	    <link href="/public/css/windows_mobile.css" type="text/css" rel="stylesheet"/>
		<script src="/public/js/wp7.js" type="text/javascript"></script>
    <% elsif System::get_property('webview_framework') =~ /^WEBKIT/ %>
        <link href="/public/css/android.css" type="text/css" rel="stylesheet"/>
    <% elsif System::get_property('platform') == 'WINDOWS' %>
	    <link href="/public/css/windows_mobile.css" type="text/css" rel="stylesheet"/>
    <% end %>
<link href="/public/css/upword.css" type="text/css" rel="stylesheet"/>
<script>
(function() {
// initializes touch and scroll events
       var supportTouch = $.support.touch,
               scrollEvent = "touchmove scroll",
               touchStartEvent = supportTouch ? "touchstart" : "mousedown",
               touchStopEvent = supportTouch ? "touchend" : "mouseup",
               touchMoveEvent = supportTouch ? "touchmove" : "mousemove";

// handles swipeup and swipedown
       $.event.special.swipeupdown = {
           setup: function() {
               var thisObject = this;
               var $this = $(thisObject);

               $this.bind(touchStartEvent, function(event) {
                   var data = event.originalEvent.touches ?
                           event.originalEvent.touches[ 0 ] :
                           event,
                           start = {
                               time: (new Date).getTime(),
                               coords: [ data.pageX, data.pageY ],
                               origin: $(event.target)
                           },
                           stop;

                   function moveHandler(event) {
                       if (!start) {
                           return;
                       }

                       var data = event.originalEvent.touches ?
                               event.originalEvent.touches[ 0 ] :
                               event;
                       stop = {
                           time: (new Date).getTime(),
                           coords: [ data.pageX, data.pageY ]
                       };

                       // prevent scrolling
                       if (Math.abs(start.coords[1] - stop.coords[1]) > 10) {
                           event.preventDefault();
                       }
                   }

                   $this
                           .bind(touchMoveEvent, moveHandler)
                           .one(touchStopEvent, function(event) {
                       $this.unbind(touchMoveEvent, moveHandler);
                       if (start && stop) {
                           if (stop.time - start.time < 1000 &&
                                   Math.abs(start.coords[1] - stop.coords[1]) > 30 &&
                                   Math.abs(start.coords[0] - stop.coords[0]) < 75) {
                               start.origin
                                       .trigger("swipeupdown")
                                       .trigger(start.coords[1] > stop.coords[1] ? "swipeup" : "swipedown");
                           }
                       }
                       start = stop = undefined;
                   });
               });
           }
       };

//Adds the events to the jQuery events special collection
       $.each({
           swipedown: "swipeupdown",
           swipeup: "swipeupdown"
       }, function(event, sourceEvent){
           $.event.special[event] = {
               setup: function(){
                   $(this).bind(sourceEvent, $.noop);
               }
           };
       });

   })();
$("#photo").live('pageshow', function(event) {
$('#photoimg').css('height',$.mobile.getScreenHeight())} 
);
   
  $i = <%= @id || 0 %>;
  $image = <%= @image || 13 %>;
$('#photoimg').css('height',$.mobile.getScreenHeight())

  $("#qpage").live('pageshow', function(event) {
    $.mobile.fixedToolbars.hide(true)
    });
  
        
  $( '#quotescreen' ).live( 'swipeleft',function(event){                                 
    $i = $i + 1;
    if ($i > 1100) {$i = 0;}
    $.mobile.changePage('/app/Quote/{' + $i + ','+$image+'}/show_by_id');                  
  });      
  $( '#quotescreen' ).live( 'vclick swiperight',function(event){                   
    $i = $i - 1;
    if ($i < 0) {$i = 1100;}
    $.mobile.changePage('/app/Quote/{' + $i + ','+$image+'}/show_by_id', {reverse: true})
$('#photoimg').css('height',$.mobile.getScreenHeight());             
   });
  $( '#quotescreen' ).live( 'swipeup',function(event){               
    $image = $image + 1;
    if ($image > 31) {$image = 1;}
    $.mobile.changePage('/app/Quote/{' + $i + ','+$image+'}/show_by_id', { transition: "slideup"})                                    
   });
  $( '#quotescreen' ).live( 'swipedown',function(event){        
    $image = $image - 1;
    if ($image < 1) {$image = 31;}              
    $.mobile.changePage('/app/Quote/{' + $i + ','+$image+'}/show_by_id', { transition: "slidedown"})                     
  });   
  
  $firstclick = 0;
  $xim = -1;
  $yim = -1;
  $width = -1;


 
                               

            
       
    
           
           

</script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30054351-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body
<% if is_bb6 %>
	data-do-fix-forms="true"
<% elsif System::get_property('platform') == 'WP7' %>
	onload="wp7_change_forms_action_to_get()"
<% end %>
	>
    <%= @content %>
</body>

</html>
